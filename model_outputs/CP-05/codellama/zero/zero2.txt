
```
<?php
function trap(array $height): int {
    // Calculate the maximum height of each bar
    $maxHeights = array_map(function($h) { return max(0, $h); }, $height);

    // Calculate the area of water trapped by each bar
    $areas = array_map(null, $maxHeights, array_slice($maxHeights, 1), array_slice($maxHeights, -1));
    $areas = array_map(function($a) { return ($a[0] < $a[1]) ? $a[0] : $a[2]; }, $areas);
    $areas = array_map(function($h) { return $h * ($h - 1); }, $areas);

    // Sum the areas of water trapped by each bar
    $totalArea = array_sum($areas);

    return $totalArea;
}
```
This solution uses a combination of `array_map()` and `array_slice()` to calculate the maximum height of each bar, the area of water trapped by each bar, and the total amount of water trapped. The algorithm is efficient because it only requires two loops through the input array, which has a time complexity of O(n).

